{"remainingRequest":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/Form.vue?vue&type=style&index=0&id=29411552&scoped=true&lang=css&","dependencies":[{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/Form.vue","mtime":1617613202481},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudmFuLWJ1dHRvbiB7CiAgICB3aWR0aDogOTUlOwogICAgbWFyZ2luOiAxNXB4IGF1dG87Cn0K"},{"version":3,"sources":["Form.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsOA;AACA;AACA;AACA","file":"Form.vue","sourceRoot":"src/views/teacher/publish","sourcesContent":["<template>\n    <div>\n        <top-nav :title=\"title\" :isShow=\"true\" />\n        <van-form @submit=\"onSubmit\">\n            <van-field required disabled readonly v-if=\"$route.path ==='/edit' ? true : false\" v-model=\"flowID\" label=\"流程ID\" rows=\"1\"  type=\"digit\" />\n            <van-field required v-model=\"model.flowName\" label=\"流程标题\" rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"流程标题\"/>\n            <van-field required disabled  label=\"流程类型\" rows=\"1\"   type=\"text\" placeholder=\"用工申请\"/>\n            <van-field required v-model=\"model.flowData.stationName\" label=\"岗位名称\" rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"岗位名称\"/>\n            <!-- <van-fild>\n                <van-collapse-item title=\"学期\" name=\"department\">\n                    <div>\n                        <van-dropdown-menu >\n                            <van-dropdown-item v-model=\"model.flowData.termId\" :options=\"terms\" @change=\"handleDept(term)\"/>\n                        </van-dropdown-menu>\n                    </div>\n                </van-collapse-item>\n            </van-fild> -->\n            <van-field required readonly clickable name=\"picker1\" :value=\"value1\" label=\"用工学期\" placeholder=\"点击选择学期\" @click=\"showPicker1 = true\"/>\n            <van-popup v-model=\"showPicker1\" position=\"bottom\">\n                <van-picker show-toolbar :columns=\"terms\" @confirm=\"onConfirmTerm\" @cancel=\"showPicker1 = false\"/>\n            </van-popup>\n\n            <van-field required readonly clickable name=\"picker2\" :value=\"value2\" label=\"岗位类别\" placeholder=\"点击选择岗位类型\" @click=\"showPicker2 = true\"/>\n            <van-popup v-model=\"showPicker2\" position=\"bottom\">\n                <van-picker show-toolbar :columns=\"stationTypes\" @confirm=\"onConfirmStationType\" @cancel=\"showPicker2 = false\"/>\n            </van-popup>\n\n            <!-- <van-field required name=\"radio\" label=\"岗位类别\">\n                <template #input>\n                    <van-radio-group v-model=\"model.flowData.stationType\" direction=\"horizontal\">\n                        <van-radio name=\"1\">一般岗</van-radio>\n                        <van-radio name=\"4\">助教岗</van-radio>\n                        <van-radio name=\"5\">助管岗</van-radio>\n                    </van-radio-group>\n                </template>\n            </van-field> -->\n\n            <!-- <van-field required label=\"人数上限\" v-model.number=\"model.flowData.totalNum\" placeholder=\"人数上限\" type=\"digit\"/> -->\n            <van-field required label=\"总需人数\" v-model.number=\"model.flowData.total_num\" placeholder=\"所需人数\" type=\"text\"/>\n            <van-field required v-if=\"staffAuth1 === 1?true:false\" label=\"贫困生数\" v-model.number=\"model.flowData.poorNum\" placeholder=\"贫困生数\" type=\"digit\"/>\n            <van-field required v-if=\"staffAuth1 === 1?true:false\" label=\"非贫人数\" v-model.number=\"model.flowData.nonpoorNum\" placeholder=\"非贫困生人数\" type=\"digit\"/>\n            <van-field required v-if=\"staffAuth2 === 1?true:false\" label=\"外院人数\" v-model.number=\"model.flowData.otherDeptNum\" placeholder=\"外学院人数\" type=\"digit\"/>\n            <van-field required label=\"开始日期\" readonly clickable name=\"calendar\" :value=\"model.flowData.workStartTime\"  placeholder=\"点击选择开始日期\" @click=\"showCalendar1 = true\"/>\n            <van-calendar :min-date=\"minDate\" :max-date=\"maxDate\" color=\"rgb(81, 125, 252)\" v-model=\"showCalendar1\" @confirm=\"onConfirmStart\" />\n            <!-- <van-field required label=\"结束日期\" readonly clickable name=\"calendar\" :value=\"model.workEndTime\"  placeholder=\"点击选择日期\" @click=\"showCalendar2 = true\"/>\n            <van-calendar :min-date=\"minDate\" :max-date=\"maxDate\" color=\"rgb(81, 125, 252)\" v-model=\"showCalendar2\" @confirm=\"onConfirmEnd\" /> -->\n            \n            <!-- <van-field required readonly clickable name=\"picker\" :value=\"stationType\" label=\"工种\" placeholder=\"点击选择工种\" @click=\"showPicker = true\"/> -->\n            <!-- <van-popup v-model=\"showPicker\" position=\"bottom\">\n                <van-picker show-toolbar :columns=\"jobCategory\" @confirm=\"onConfirmJob\" @cancel=\"showPicker = false\"/>\n            </van-popup> -->\n            <!-- <van-field required name=\"radio\" label=\"院校级别\">\n                <template #input>\n                    <van-radio-group v-model=\"model.stationScope\" direction=\"horizontal\">\n                        <van-radio name=\"1\">校级岗</van-radio>\n                        <van-radio name=\"2\">院级岗</van-radio>\n                    </van-radio-group>\n                </template>\n            </van-field> -->\n            <!-- <van-field label=\"技能要求\" v-model=\"model.skillQeruire\"  rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"技能要求\"/> -->\n            <van-field required label=\"工作内容\" v-model=\"model.flowData.stationContent\" rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"工作内容\"/>\n            <van-field required label=\"工作地点\" v-model=\"model.flowData.stationLocation\" rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"工作地点\"/>\n            <van-field label=\"申请说明\" v-model=\"model.flowData.remarks\"  rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"申请说明\"/>\n            <!-- <van-field label=\"备注说明\" v-model=\"model.remarkContent\" rows=\"1\" autosize clearable type=\"textarea\" placeholder=\"其他说明\"/> -->\n            <van-button round block type=\"info\" native-type=\"submit\">\n                {{$route.path ==='/publishment' ? '确认提交' : '确认修改'}}\n            </van-button>\n        </van-form>\n    </div>\n</template>\n\n<script>\nimport TopNav from '@/components/common/TopNav.vue'\nexport default {\n    props: ['title','flowID'],\n    data() {\n        return {\n            detail: {},\n            value1:'',\n            value2:'',\n            model: {\n                // flowId:'',  第一次发起申请的时候没有 不用填写这个\n                flowName:'',\n                procType:\"4\", // 4-用工申请 或者 5-工时申请\n                flowData:{\n                    termId:'',\n                    stationType:'', //岗位类别，1-一般岗，4-助教岗，5-助管岗，如不选，默认为一般岗\n                    totalNum:'',  // 总人数上限\n                    nonpoorNum:0,\n                    otherDeptNum:0,\n                    remarks:'', // 申请说明信息\n                    stationName:'',\n                    // stationType:'', //工种 老师用工申请时必填\n                    // 注意这个是 写死了\n                    deptId:'', //申请老师部门\n                    total_num:'', //用工申请人数\n                    workStartTime:'',\n                    stationContent:'', // 用工内容\n                    stationLocation: '' //用工地点\n                },\n                \n            },\n            staffAuth1:'',\n            staffAuth2:'',\n            terms: [\n                { text: '2020年第二学期', value: 3 },\n                { text: '2021年第一学期', value: 2 },\n                { text: '2021年第二学期', value: 4 },\n            ],\n            term: '',\n            termOptions: [],\n            stationTypes:[\n                {text:'本科生固定岗',value:\"1\"},\n                {text:'本科生临时岗',value:\"2\"},\n                {text:'本科生假期岗',value:\"3\"},\n                {text:'研究生助教岗',value:\"4\"},\n                {text:'研究生助管岗',value:\"5\"},\n                {text:'研究生助研岗',value:\"4\"},\n                {text:'研究生辅导员',value:\"5\"},\n                ],\n            stationType: '',\n            jobCategory: ['固定岗','临时岗','假期岗','助教岗','研究生助教'],\n            showCalendar1: false,\n            showCalendar2: false,\n            showPicker: false,\n            showPicker1: false,\n            showPicker2: false,\n            minDate: new Date(2020, 0, 1), // 测试日期 后端设置的测试日期范围 不在这个范围提交便会报错！\n            maxDate: new Date(2021, 11, 31), // 测试日期 后端设置的测试日期范围 不在这个范围提交便会报错！\n        }\n    },\n    components: {\n        TopNav\n    },\n    methods: {\n        getstaffAuths(){\n            this.staffAuth1 = sessionStorage.getItem('staffAuth1');\n            this.staffAuth2 = sessionStorage.getItem('staffAuth2');\n            this.model.flowData.deptId = sessionStorage.getItem('deptId')-0;\n            console.log(\"deptId:\"+this.model.flowData.deptId)\n\n        },\n        onConfirmStart(date) {\n            this.model.flowData.workStartTime = this.formatMyDate(date)\n            this.showCalendar1 = false;\n        },\n        onConfirmEnd(date) {\n            this.model.workEndTime = this.formatMyDate(date)\n            this.showCalendar2 = false;\n        },\n        onConfirmJob(value,index) {\n            this.stationType = value\n            this.model.stationType = `${index + 1}`\n            this.showPicker = false\n        },\n        onConfirmTerm(value) {\n            this.value1 = value.text\n            this.model.flowData.termId = value.value\n            this.showPicker1 = false\n        },\n        onConfirmStationType(value) {\n            this.value2= value.text;\n            this.model.flowData.stationType = value.value\n            // console.log(\"index:\"+ value.text);\n            // console.log(\"index:\"+ value.value);\n            this.showPicker2 = false\n        },\n        async onSubmit() {\n            // var isEmplty = false\n            // for(let key in this.model) {\n            //     if(key !== 'poorNum' && key!=='nonpoorNum' && key!=='otherDeptNum' && key!=='skillQeruire' && key!=='remarkContent') {\n            //         if(!this.model[key]) {\n            //             this.$toast.fail('必填项不能为空!!!')\n            //             isEmplty = true\n            //             break\n            //         }\n            //     }\n            // }\n            // if(!isEmplty) {\n                var res\n                if(this.$route.path ==='/edit'){\n                    this.model.flowId = this.flowID;\n                     res = await this.$ajax.post('/system/flows/startFlow', this.model)\n                }else{\n                     res = await this.$ajax.post('/system/flows/startFlow', this.model)\n                }\n                if(res.data.code === 200) {\n                    this.$toast.success(res.data.msg)\n                    this.$router.push('/publish')\n                }else {\n                    this.$toast.fail('操作失败，请稍后重试')\n                }\n            // }\n        },\n        formatMyDate(date) {\n            let year = date.getFullYear()\n            let month = date.getMonth() + 1\n            month = month < 10 ? ('0' + month) : month\n            let d = date.getDate()\n            d = d < 10 ? ('0' + d) : d\n            return `${year}-${month}-${d}`\n        },\n        getTermOptions() {\n            const year = new Date().getFullYear()\n            if(new Date().getMonth() + 1< 9) {\n                const term = `${year -1}-${year}`\n                return [`${term}第一学期`, `${term}第二学期`]\n            } else {\n                const term = `${year}-${year + 1}`\n                return [`${term}第一学期`, `${term}第二学期`]\n            }\n        },\n        async getTermList(){\n            const res = await this.$ajax.get('/system/term/list')\n            if(res.data.code === 200){\n                console.log(res.data);\n            }\n        },\n    },\n   \n    mounted() {\n        this.getTermList();\n        this.getstaffAuths();\n        this.termOptions = this.getTermOptions()\n        console.log(this.flowID)\n    }\n}\n</script>\n\n<style scoped>\n.van-button {\n    width: 95%;\n    margin: 15px auto;\n}\n</style>"]}]}