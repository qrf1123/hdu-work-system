{"remainingRequest":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/shenpi.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/shenpi.vue","mtime":1619628534623},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMaXN0TGF5b3V0IGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vTGlzdExheW91dC52dWUnCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcHVibGlzaExpc3Q6IFtdLAogICAgICAgICAgICBzaG93OiBmYWxzZSwKICAgICAgICAgICAgcHJvY2Vzc1N0YXR1czogMSwKICAgICAgICAgICAgcGFnZU51bTogMSwKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgIGZpbmlzaGVkOiBmYWxzZSwKICAgICAgICAgICAgZmxvd1N0ZXBzOltdCiAgICAgICAgfQogICAgfSwKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICAvLyBUb3BOYXYsCiAgICAgICAgLy8gQm90dG9tTmF2LAogICAgICAgIExpc3RMYXlvdXQsCiAgICAgICAgLy8gVGFicywKICAgICAgICAvLyBzaGVucGksCiAgICAgICAgLy8gbXlzdGF0aW9ucwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBhc3luYyBoYW5kbGVEZWxldGUoaW5kZXgsaWQpIHsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5wdWJsaXNoTGlzdFtpbmRleF0pCiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGFqYXgucG9zdCgnL2FwaS9hY3Rpdml0aS9kZWxldGVQcm9jZXNzJywge3Byb2Nlc3NJbnN0YW5jZUlkOiBpZH0pCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKQogICAgICAgICAgICBpZihyZXMuZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaExpc3Quc3BsaWNlKGluZGV4LDEpCiAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdC5zdWNjZXNzKHJlcy5tc2cpCiAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0LmZhaWwoJ+WIoOmZpOWksei0pe+8jOivt+eojeWQjumHjeivle+8gScpCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIGRlbGV0ZUZsb3dBcHBseShpZCl7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGFqYXgucG9zdCgnL3N5c3RlbS9mbG93cy9kZWxldGVGbG93Jyx7Zmxvd0lkOmlkfSkKICAgICAgICAgICAgaWYocmVzLmRhdGEuY29kZSA9PT0gMjAwKXsKICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0KCLliKDpmaTmiJDlip8iKTsKICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UHVibGlzaCgpCiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgdGhpcy4kdG9hc3QoIuWIoOmZpOWksei0pe+8jOivt+mHjeivlSIpCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvRWRpdChmbG93SWQsZmxvd05hbWUpewogICAgICAgICAgICBjb25zb2xlLmxvZyhmbG93SWQsZmxvd05hbWUpOwogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7cGF0aDonL2VkaXQnLHF1ZXJ5OntmbG93SWQgOiBmbG93SWQsZmxvd05hbWUgOiBmbG93TmFtZX19KQogICAgICAgIH0sCiAgICAgICAgLy8gaGFuZGxlRGV0YWlsKGl0ZW0pIHsKICAgICAgICAvLyAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIC8vICAgICAgICAgcGF0aDogJy9qb2JJbmZvJywKICAgICAgICAvLyAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgLy8gICAgICAgICAgICAgaXRlbTogaXRlbQogICAgICAgIC8vICAgICAgICAgfQogICAgICAgIC8vICAgICB9KQogICAgICAgIC8vIH0sCiAgICAgICAgYXN5bmMgZ2V0UHVibGlzaCgpIHsKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kYWpheC5nZXQoYC9zeXN0ZW0vZmxvd3MvcXVlcnlNeUZsb3dzYCkKICAgICAgICAgICAgaWYocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICByZXMuZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5jcmVhdGVUaW1lID0gaXRlbS5jcmVhdGVUaW1lLnNsaWNlKDAsMTApOwogICAgICAgICAgICAgICAgICAgIC8v5rKh5pyJ5pu05paw5pe26Ze0IOmCo+S5iOabtOaWsOaXtumXtOS4uuWIm+W7uuaXtumXtAogICAgICAgICAgICAgICAgICAgIGlmKCFpdGVtLnVwZGF0ZVRpbWUpewogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnVwZGF0ZVRpbWUgPSBpdGVtLmNyZWF0ZVRpbWU7CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udXBkYXRlVGltZSA9IGl0ZW0udXBkYXRlVGltZS5zbGljZSgwLDEwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpdGVtLmZsb3dTdGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiMSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5mbG93U3RhdGUgPSAi5bey5b2S5qGjIiAvLyDmmoLkuJTorqTkuLrmmK8g5a6h5qC46YCa6L+H55qE5Y+tCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICIyIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmZsb3dTdGF0ZSA9ICLlt7LliKDpmaQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICIzIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmZsb3dTdGF0ZSA9ICLlrqHmoLjkuK0iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICI0IjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmZsb3dTdGF0ZSA9ICLooqvpqbPlm54iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaExpc3QgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnB1Ymxpc2hMaXN0KTsKICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIGhhbmRsZVN0ZXAocHJvY2Vzc0lkKSB7CiAgICAgICAgICAgIHRoaXMuc2hvdyA9IHRydWUKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kYWpheC5nZXQoJy9zeXN0ZW0vZmxvd3MvcXVlcnlGbG93T3BlcnMnLCB7cGFyYW1zOiB7Zmxvd0lkOiBwcm9jZXNzSWR9fSkKICAgICAgICAgICAgdGhpcy5mbG93U3RlcHMgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgIC8vIHRoaXMuZmxvd1N0ZXBzLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIC8vICAgICBpZihpdGVtLikKICAgICAgICAgICAgLy8gfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZmxvd1N0ZXBzKTsKICAgICAgICAgICAgdGhpcy5mbG93U3RlcHMgPSB0aGlzLnNvcnRBc2NCeUtleSh0aGlzLmZsb3dTdGVwcywoIm9wZXJTdGF0dXMiKSkKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5mbG93U3RlcHMpOwogICAgICAgIH0sCiAgICAgICAgc29ydEFzY0J5S2V5KGFycixrZXkpewogICAgICAgICAgICByZXR1cm4gYXJyLnNvcnQoKGEsYik9PnsKICAgICAgICAgICAgICAgIGxldCB4ID0gYVtrZXldOwogICAgICAgICAgICAgICAgbGV0IHkgPSBiW2tleV07CiAgICAgICAgICAgICAgICByZXR1cm4gKCh4PHkpPy0xOih4PnkpPzE6MCkKICAgICAgICAgICAgIH0pCiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5nZXRQdWJsaXNoKCkKICAgIH0KfQo="},{"version":3,"sources":["shenpi.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shenpi.vue","sourceRoot":"src/views/teacher/publish","sourcesContent":["<template>\n    <van-tab title=\"审批流程\">\n        <!-- 查看审批流程中间过程的的  -->\n        <van-dialog v-model=\"show\">\n            <van-steps :active=\"0\" direction=\"vertical\" active-color=\"rgb(36, 126, 255)\" active-icon=\"success\">\n            <!-- <van-steps :active=\"0\" direction=\"vertical\" active-color=\"rgb(36, 126, 255)\" active-icon=\"cross\"> -->\n                <!-- <van-step v-for=\"(item,index) in flowSteps\" :key=\"index\">{{item.nickName}}</van-step> -->\n                <van-step >用工老师</van-step>\n                <van-step >本部门/学院二级管理员</van-step>\n            </van-steps>\n        </van-dialog>\n        <ul class=\"list\">\n            <!-- <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"加载完成!!!\" @load=\"onLoad\"> -->\n            <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"加载完成!!!\" >\n                <list-layout :firstLayout=\"0\" v-for=\"(item,index) in publishList\" :key=\"index\">\n                    <van-icon size=\"40\" color=\"rgb(81, 125, 252)\" name=\"info\" slot=\"left-icon\"/>\n                    <div slot=\"content\">\n                        <h4>{{item.flowName}}</h4>\n                        <div>\n                            <span>{{item.updateTime}}</span>\n                        </div>\n                    </div>\n                    <div slot=\"right\">\n                        <span class=\"date\">{{item.flowState}}</span>\n                        <div class=\"right-bottom\">\n                            <van-icon v-if=\"item.flowState === '被驳回'\"  @click=\"toEdit(item.flowId,item.flowName)\" size=\"20\" color=\"rgb(81, 125, 252)\" name=\"edit\"/>\n                            <van-button style=\"margin-left: 10px\" v-if=\"item.flowState === '审核中'\" color=\"rgb(81, 125, 252)\" size=\"mini\" @click=\"handleStep(item.flowId)\">查看审批</van-button>\n                            <van-button v-if=\"item.flowState === '被驳回' \" style=\"margin-left: 10px\"  color=\"rgb(81, 125, 252)\" size=\"mini\" @click=\"deleteFlowApply(item.flowId)\">删除申请</van-button>\n                        </div>\n                    </div>\n                </list-layout>\n            </van-list>\n        </ul>\n    </van-tab>\n</template>\n\n<script>\nimport ListLayout from '@/components/common/ListLayout.vue'\nexport default {\n    data() {\n        return {\n            publishList: [],\n            show: false,\n            processStatus: 1,\n            pageNum: 1,\n            loading: false,\n            finished: false,\n            flowSteps:[]\n        }\n    },\n    components: {\n        // TopNav,\n        // BottomNav,\n        ListLayout,\n        // Tabs,\n        // shenpi,\n        // mystations\n    },\n    methods: {\n        async handleDelete(index,id) {\n            console.log(this.publishList[index])\n            const res = await this.$ajax.post('/api/activiti/deleteProcess', {processInstanceId: id})\n            console.log(res.data)\n            if(res.data.code === 200) {\n                this.publishList.splice(index,1)\n                this.$toast.success(res.msg)\n            }else {\n                this.$toast.fail('删除失败，请稍后重试！')\n            }\n        },\n        async deleteFlowApply(id){\n            const res = await this.$ajax.post('/system/flows/deleteFlow',{flowId:id})\n            if(res.data.code === 200){\n                this.$toast(\"删除成功\");\n                this.finished = false;\n                this.getPublish()\n            }else{\n                this.$toast(\"删除失败，请重试\")\n            }\n        },\n        toEdit(flowId,flowName){\n            console.log(flowId,flowName);\n            this.$router.push({path:'/edit',query:{flowId : flowId,flowName : flowName}})\n        },\n        // handleDetail(item) {\n        //     this.$router.push({\n        //         path: '/jobInfo',\n        //         query: {\n        //             item: item\n        //         }\n        //     })\n        // },\n        async getPublish() {\n            const res = await this.$ajax.get(`/system/flows/queryMyFlows`)\n            if(res.data.code === 200) {\n                res.data.data.forEach(item => {\n                    item.createTime = item.createTime.slice(0,10);\n                    //没有更新时间 那么更新时间为创建时间\n                    if(!item.updateTime){\n                        item.updateTime = item.createTime;\n                    }else{\n                        item.updateTime = item.updateTime.slice(0,10);\n                    }\n                    switch (item.flowState) {\n                            case \"1\":\n                                item.flowState = \"已归档\" // 暂且认为是 审核通过的叭\n                                break;\n                            case \"2\":\n                                item.flowState = \"已删除\"\n                                break;\n                            case \"3\":\n                                item.flowState = \"审核中\"\n                                break;\n                            case \"4\":\n                                item.flowState = \"被驳回\"\n                                break;\n                            default:\n                                break;\n                        }\n                });\n                this.publishList = res.data.data\n                console.log(this.publishList);\n                this.finished = true\n            }\n        },\n        async handleStep(processId) {\n            this.show = true\n            const res = await this.$ajax.get('/system/flows/queryFlowOpers', {params: {flowId: processId}})\n            this.flowSteps = res.data.data\n            // this.flowSteps.forEach(item => {\n            //     if(item.)\n            // });\n            console.log(this.flowSteps);\n            this.flowSteps = this.sortAscByKey(this.flowSteps,(\"operStatus\"))\n            console.log(this.flowSteps);\n        },\n        sortAscByKey(arr,key){\n            return arr.sort((a,b)=>{\n                let x = a[key];\n                let y = b[key];\n                return ((x<y)?-1:(x>y)?1:0)\n             })\n        }\n    },\n    mounted() {\n        this.getPublish()\n    }\n}\n</script>\n\n<style scoped>\n    .middle {\n        margin: 0 10px;\n    }\n    .van-cell {\n        margin-bottom: 10px;\n    }\n</style>"]}]}