{"remainingRequest":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenrixin/HDUWorkStudy/Mobile/src/views/user/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/src/views/user/Login.vue","mtime":1605768204000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBUb3BOYXYgZnJvbSAnQC9jb21wb25lbnRzL2NvbW1vbi9Ub3BOYXYudnVlJwpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG1vZGVsOiB7CiAgICAgICAgICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2hlY2tlZDogZmFsc2UKICAgICAgICB9CiAgICB9LAogICAgY29tcG9uZW50czogewogICAgICAgIFRvcE5hdgogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBhc3luYyBsb2dpbigpIHsKICAgICAgICAgICAgaWYodGhpcy5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNMb2dpbiA9IGF3YWl0IHRoaXMuJGFqYXgucG9zdCgnL2FwaUxvZ2luJyx0aGlzLm1vZGVsKQogICAgICAgICAgICAgICAgaWYocmVzTG9naW4uZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCd0b2tlbicscmVzTG9naW4uZGF0YS50b2tlbikKICAgICAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdC5mYWlsKHJlc0xvZ2luLmRhdGEubXNnKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgcmVzSW5mbyA9IGF3YWl0IHRoaXMuJGFqYXguZ2V0KCcvZ2V0SW5mbycpCiAgICAgICAgICAgICAgICBpZihyZXNJbmZvLmRhdGEuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzSW5mby5kYXRhKQogICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3JvbGVzJywgSlNPTi5zdHJpbmdpZnkocmVzSW5mby5kYXRhLmRhdGEucm9sZXMpKQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0LnN1Y2Nlc3Moe21lc3NhZ2U6ICfnmbvpmYbmiJDlip8nLGR1cmF0aW9uOiAxMDAwfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCByb2xlID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgncm9sZXMnKQogICAgICAgICAgICAgICAgICAgIGlmKHJvbGUgJiYgcm9sZS5pbmNsdWRlcygn5a2m55SfJykpewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2VtcGxveW1lbnQnKQogICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKHJvbGUgJiYgcm9sZS5pbmNsdWRlcygn55So5bel6ICB5biIJykpewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL21lc3NhZ2UnKQogICAgICAgICAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kdG9hc3QuZmFpbCgn6KeS6Imy5LiN5a2Y5ZyoIScpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwxMDAwKQogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdCgn6K+35Yu+6YCJ6aOO6Zmp5ZGK55+l5LmmJykKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n    <div class=\"login\">\n        <top-nav title=\"登录\" :isShow=\"false\" />\n        <div class=\"logo\">\n            <img src=\"@/assets/image/logo-hdu.png\" alt=\"logo for school\" />\n            <span>杭州电子科技大学</span>\n        </div>\n        <van-form @submit=\"login\">\n            <van-field :border=\"false\" v-model=\"model.username\" label=\"用户名\" placeholder=\"请输入学号/工号\" left-icon=\"user-o\" clearable/>\n            <van-field :border=\"false\" v-model=\"model.password\" type=\"password\" placeholder=\"请输入密码\" label=\"密码\" left-icon=\"lock\" clearable/>\n            <div class=\"checked\">\n                <a>忘记密码？</a>\n                <van-checkbox v-model=\"checked\" shape=\"square\"><a>风险告知书</a></van-checkbox>\n            </div>\n            <van-button round block color=\"rgb(81, 125, 252)\" native-type=\"submit\">\n                登录\n            </van-button>\n        </van-form>\n    </div>\n</template>\n\n<script>\nimport TopNav from '@/components/common/TopNav.vue'\nexport default {\n    data() {\n        return {\n            model: {\n                username: '',\n                password: ''\n            },\n            checked: false\n        }\n    },\n    components: {\n        TopNav\n    },\n    methods: {\n        async login() {\n            if(this.checked) {\n                const resLogin = await this.$ajax.post('/apiLogin',this.model)\n                if(resLogin.data.code === 200) {\n                    sessionStorage.setItem('token',resLogin.data.token)\n                }else {\n                    this.$toast.fail(resLogin.data.msg)\n                }\n                const resInfo = await this.$ajax.get('/getInfo')\n                if(resInfo.data.code === 200) {\n                    console.log(resInfo.data)\n                    sessionStorage.setItem('roles', JSON.stringify(resInfo.data.data.roles))\n                    this.$toast.success({message: '登陆成功',duration: 1000})\n                }\n                setTimeout(() => {\n                    let role = sessionStorage.getItem('roles')\n                    if(role && role.includes('学生')){\n                        this.$router.push('/employment')\n                    }else if(role && role.includes('用工老师')){\n                        this.$router.push('/message')\n                    }else {\n                        this.$toast.fail('角色不存在!')\n                    }\n                },1000)\n            }else {\n                this.$toast('请勾选风险告知书')\n            }\n        }\n    }\n}\n</script>\n\n<style scoped>\n    .logo {\n        text-align: center;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n    }\n    .logo img {\n        height: 130px;\n        width: 130px;\n        border-radius: 50%;\n        margin-top: 50px;\n    }\n    .logo span {\n        font-size: 14px;\n        margin-top: 10px;\n        margin-bottom: 30px;\n    }\n\n    .van-form {\n        padding: 0 20px;\n    }\n    .van-form .van-field {\n        margin-bottom: 10px;\n        border: 1px solid #eee;\n        border-radius: 3px;\n    }\n    .checked {\n        color: #323233;\n        display: flex;\n        justify-content: space-between;\n        padding: 10px 5px;\n        font-size: 14px;\n    }\n</style>"]}]}