{"remainingRequest":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/Publish.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/Publish.vue","mtime":1614310652873},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBUb3BOYXYgZnJvbSAnQC9jb21wb25lbnRzL2NvbW1vbi9Ub3BOYXYudnVlJwppbXBvcnQgQm90dG9tTmF2IGZyb20gJ0AvY29tcG9uZW50cy90ZWFjaGVyL0JvdHRvbU5hdi52dWUnCmltcG9ydCBMaXN0TGF5b3V0IGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vTGlzdExheW91dC52dWUnCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcHVibGlzaExpc3Q6IFtdLAogICAgICAgICAgICBzaG93OiBmYWxzZSwKICAgICAgICAgICAgcHJvY2Vzc1N0YXR1czogMCwKICAgICAgICAgICAgcGFnZU51bTogMSwKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgIGZpbmlzaGVkOiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgVG9wTmF2LAogICAgICAgIEJvdHRvbU5hdiwKICAgICAgICBMaXN0TGF5b3V0CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGFzeW5jIGhhbmRsZURlbGV0ZShpbmRleCxpZCkgewogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnB1Ymxpc2hMaXN0W2luZGV4XSkKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kYWpheC5wb3N0KCcvYXBpL2FjdGl2aXRpL2RlbGV0ZVByb2Nlc3MnLCB7cHJvY2Vzc0luc3RhbmNlSWQ6IGlkfSkKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpCiAgICAgICAgICAgIGlmKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgdGhpcy5wdWJsaXNoTGlzdC5zcGxpY2UoaW5kZXgsMSkKICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0LnN1Y2Nlc3MocmVzLm1zZykKICAgICAgICAgICAgfWVsc2UgewogICAgICAgICAgICAgICAgdGhpcy4kdG9hc3QuZmFpbCgn5Yig6Zmk5aSx6LSl77yM6K+356iN5ZCO6YeN6K+V77yBJykKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaGFuZGxlRGV0YWlsKGlkKSB7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIHBhdGg6ICcvam9iSW5mbycsCiAgICAgICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJbnN0YW5jZUlkOiBpZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgb25Mb2FkKCkgewogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMucGFnZU51bSsrCiAgICAgICAgICAgICAgICB0aGlzLmdldFB1Ymxpc2goKQogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgfSwxMDAwKQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZ2V0UHVibGlzaCgpIHsKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kYWpheC5nZXQoYC9hcGkvYWN0aXZpdGkvZ2V0TXlQdWJsaXNoU2F0aW9uP3BhZ2VOdW09JHt0aGlzLnBhZ2VOdW19JnBhZ2VTaXplPTdgKQogICAgICAgICAgICBpZihyZXMuZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXMuZGF0YS5kYXRhLmRhdGEKICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaExpc3QucHVzaCguLi5saXN0KQogICAgICAgICAgICAgICAgaWYobGlzdC5sZW5ndGggPCA3KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgaGFuZGxlU3RlcChwcm9jZXNzSWQpIHsKICAgICAgICAgICAgdGhpcy5zaG93ID0gdHJ1ZQogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRhamF4LmdldCgnL2FwaS9hY3Rpdml0aS9xdWVyeVRhc2tEZXRhaWxzJywge3BhcmFtczoge3Byb2Nlc3NJbnN0YW5jZUlkOiBwcm9jZXNzSWR9fSkKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpCiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHJlcy5kYXRhLmRhdGFbMF0ucmVqZWN0U3RhdHVzCiAgICAgICAgICAgIHRoaXMucHJvY2Vzc1N0YXR1cyA9IHBhcnNlSW50KHN0YXR1cykKICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLmdldFB1Ymxpc2goKQogICAgfQp9Cg=="},{"version":3,"sources":["Publish.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Publish.vue","sourceRoot":"src/views/teacher/publish","sourcesContent":["<template>\n    <div class=\"publish\">\n        <top-nav title=\"发布管理\" :isShow=\"false\" />\n        <van-cell center title=\"发布用工\" icon=\"wap-nav\">\n            <template #right-icon>\n                <van-icon name=\"plus\" @click=\"$router.push('/publishment')\" size=\"16\"/>\n            </template>\n        </van-cell>\n        <van-dialog v-model=\"show\">\n            <van-steps :active=\"processStatus\" direction=\"vertical\" active-color=\"rgb(36, 126, 255)\">\n                <van-step>已发布</van-step>\n                <van-step>已审批(二级管理员)</van-step>\n                <van-step>待审批(部门管理员)</van-step>\n                <van-step>待审批(一级管理员)</van-step>\n            </van-steps>\n        </van-dialog>\n        <ul class=\"list\">\n            <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"加载完成!!!\" @load=\"onLoad\">\n                <list-layout :firstLayout=\"0\" v-for=\"(item,index) in publishList\" :key=\"index\">\n                    <van-icon size=\"40\" color=\"rgb(81, 125, 252)\" name=\"info\" slot=\"left-icon\"/>\n                    <div slot=\"content\">\n                        <h4 @click=\"handleDetail(item.processInstanceId)\">{{item.stationSubject}}</h4>\n                        <div>\n                            <span>{{item.operateDate}}</span>\n                        </div>\n                    </div>\n                    <div slot=\"right\">\n                        <span class=\"date\">{{item.state}}</span>\n                        <div class=\"right-bottom\">\n                            <van-icon v-if=\"item.stateCode === '4' || item.stateCode === '1'\" @click=\"$router.push('/edit')\" size=\"20\" color=\"rgb(81, 125, 252)\" name=\"edit\"/>\n                            <van-icon v-if=\"item.stateCode === '4'\" class=\"middle\" size=\"20\" color=\"rgb(227, 96, 85)\" name=\"delete\" @click=\"handleDelete(index,item.processInstanceId)\" />\n                            <van-button v-if=\"item.stateCode === '4'\" color=\"rgb(81, 125, 252)\" size=\"mini\">作废</van-button>\n                            <van-button style=\"margin-left: 10px\" v-if=\"item.stateCode === '1'\" color=\"rgb(81, 125, 252)\" size=\"mini\" @click=\"handleStep(item.processInstanceId)\">查看审批</van-button>\n                        </div>\n                    </div>\n                </list-layout>\n            </van-list>\n        </ul>\n        <bottom-nav :active=\"3\"/>\n    </div>\n</template>\n\n<script>\nimport TopNav from '@/components/common/TopNav.vue'\nimport BottomNav from '@/components/teacher/BottomNav.vue'\nimport ListLayout from '@/components/common/ListLayout.vue'\nexport default {\n    data() {\n        return {\n            publishList: [],\n            show: false,\n            processStatus: 0,\n            pageNum: 1,\n            loading: false,\n            finished: false\n        }\n    },\n    components: {\n        TopNav,\n        BottomNav,\n        ListLayout\n    },\n    methods: {\n        async handleDelete(index,id) {\n            console.log(this.publishList[index])\n            const res = await this.$ajax.post('/api/activiti/deleteProcess', {processInstanceId: id})\n            console.log(res.data)\n            if(res.data.code === 200) {\n                this.publishList.splice(index,1)\n                this.$toast.success(res.msg)\n            }else {\n                this.$toast.fail('删除失败，请稍后重试！')\n            }\n        },\n        handleDetail(id) {\n            this.$router.push({\n                path: '/jobInfo',\n                query: {\n                    processInstanceId: id\n                }\n            })\n        },\n        onLoad() {\n            setTimeout(() => {\n                this.pageNum++\n                this.getPublish()\n                this.loading = false\n            },1000)\n        },\n        async getPublish() {\n            const res = await this.$ajax.get(`/api/activiti/getMyPublishSation?pageNum=${this.pageNum}&pageSize=7`)\n            if(res.data.code === 200) {\n                const list = res.data.data.data\n                this.publishList.push(...list)\n                if(list.length < 7) {\n                    this.finished = true\n                }\n            }\n        },\n        async handleStep(processId) {\n            this.show = true\n            const res = await this.$ajax.get('/api/activiti/queryTaskDetails', {params: {processInstanceId: processId}})\n            console.log(res.data)\n            const status = res.data.data[0].rejectStatus\n            this.processStatus = parseInt(status)\n        }\n    },\n    mounted() {\n        this.getPublish()\n    }\n}\n</script>\n\n<style scoped>\n    .middle {\n        margin: 0 10px;\n    }\n    .van-cell {\n        margin-bottom: 10px;\n    }\n</style>"]}]}