{"remainingRequest":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/Publish.vue?vue&type=style&index=0&id=4f0b9b6b&scoped=true&lang=css&","dependencies":[{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/src/views/teacher/publish/Publish.vue","mtime":1605768204000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenrixin/HDUWorkStudy/Mobile/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLm1pZGRsZSB7CiAgICBtYXJnaW46IDAgMTBweDsKfQoudmFuLWNlbGwgewogICAgbWFyZ2luLWJvdHRvbTogMTBweDsKfQo="},{"version":3,"sources":["Publish.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;AACA","file":"Publish.vue","sourceRoot":"src/views/teacher/publish","sourcesContent":["<template>\n    <div class=\"publish\">\n        <top-nav title=\"发布管理\" :isShow=\"false\" />\n        <van-cell center title=\"发布用工\" icon=\"wap-nav\">\n            <template #right-icon>\n                <van-icon name=\"plus\" @click=\"$router.push('/publishment')\" size=\"16\"/>\n            </template>\n        </van-cell>\n        <van-dialog v-model=\"show\">\n            <van-steps :active=\"processStatus\" direction=\"vertical\" active-color=\"rgb(36, 126, 255)\">\n                <van-step>已发布</van-step>\n                <van-step>已审批(二级管理员)</van-step>\n                <van-step>待审批(部门管理员)</van-step>\n                <van-step>待审批(一级管理员)</van-step>\n            </van-steps>\n        </van-dialog>\n        <ul class=\"list\">\n            <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"加载完成!!!\" @load=\"onLoad\">\n                <list-layout :firstLayout=\"0\" v-for=\"(item,index) in publishList\" :key=\"index\">\n                    <van-icon size=\"40\" color=\"rgb(81, 125, 252)\" name=\"info\" slot=\"left-icon\"/>\n                    <div slot=\"content\">\n                        <h4 @click=\"handleDetail(item.processInstanceId)\">{{item.stationSubject}}</h4>\n                        <div>\n                            <span>{{item.operateDate}}</span>\n                        </div>\n                    </div>\n                    <div slot=\"right\">\n                        <span class=\"date\">{{item.state}}</span>\n                        <div class=\"right-bottom\">\n                            <van-icon v-if=\"item.stateCode === '4' || item.stateCode === '1'\" @click=\"$router.push('/edit')\" size=\"20\" color=\"rgb(81, 125, 252)\" name=\"edit\"/>\n                            <van-icon v-if=\"item.stateCode === '4'\" class=\"middle\" size=\"20\" color=\"rgb(227, 96, 85)\" name=\"delete\" @click=\"handleDelete(index,item.processInstanceId)\" />\n                            <van-button v-if=\"item.stateCode === '4'\" color=\"rgb(81, 125, 252)\" size=\"mini\">作废</van-button>\n                            <van-button style=\"margin-left: 10px\" v-if=\"item.stateCode === '1'\" color=\"rgb(81, 125, 252)\" size=\"mini\" @click=\"handleStep(item.processInstanceId)\">查看审批</van-button>\n                        </div>\n                    </div>\n                </list-layout>\n            </van-list>\n        </ul>\n        <bottom-nav :active=\"1\"/>\n    </div>\n</template>\n\n<script>\nimport TopNav from '@/components/common/TopNav.vue'\nimport BottomNav from '@/components/teacher/BottomNav.vue'\nimport ListLayout from '@/components/common/ListLayout.vue'\nexport default {\n    data() {\n        return {\n            publishList: [],\n            show: false,\n            processStatus: 0,\n            pageNum: 1,\n            loading: false,\n            finished: false\n        }\n    },\n    components: {\n        TopNav,\n        BottomNav,\n        ListLayout\n    },\n    methods: {\n        async handleDelete(index,id) {\n            console.log(this.publishList[index])\n            const res = await this.$ajax.post('/api/activiti/deleteProcess', {processInstanceId: id})\n            console.log(res.data)\n            if(res.data.code === 200) {\n                this.publishList.splice(index,1)\n                this.$toast.success(res.msg)\n            }else {\n                this.$toast.fail('删除失败，请稍后重试！')\n            }\n        },\n        handleDetail(id) {\n            this.$router.push({\n                path: '/jobInfo',\n                query: {\n                    processInstanceId: id\n                }\n            })\n        },\n        onLoad() {\n            setTimeout(() => {\n                this.pageNum++\n                this.getPublish()\n                this.loading = false\n            },1000)\n        },\n        async getPublish() {\n            const res = await this.$ajax.get(`/api/activiti/getMyPublishSation?pageNum=${this.pageNum}&pageSize=7`)\n            if(res.data.code === 200) {\n                const list = res.data.data.data\n                this.publishList.push(...list)\n                if(list.length < 7) {\n                    this.finished = true\n                }\n            }\n        },\n        async handleStep(processId) {\n            this.show = true\n            const res = await this.$ajax.get('/api/activiti/queryTaskDetails', {params: {processInstanceId: processId}})\n            console.log(res.data)\n            const status = res.data.data[0].rejectStatus\n            this.processStatus = parseInt(status)\n        }\n    },\n    mounted() {\n        this.getPublish()\n    }\n}\n</script>\n\n<style scoped>\n    .middle {\n        margin: 0 10px;\n    }\n    .van-cell {\n        margin-bottom: 10px;\n    }\n</style>"]}]}